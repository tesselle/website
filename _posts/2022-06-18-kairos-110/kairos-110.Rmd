---
title: "kairos 1.1.0"
slug: tesselle-kairos-110
description: |
  Archaeological seriation of abundance matrices.
categories:
  - packages
  - releases
author:
  - name: Nicolas Frerebeau
    url: https://www.archaeo.science
    affiliation: Arch√©osciences Bordeaux (UMR 6034)
    affiliation_url: https://www.archeosciences-bordeaux.fr
    orcid_id: 0000-0001-5759-4944
date: 2022-06-18
output:
  distill::distill_article:
    toc: true
    toc_float: true
    self_contained: false
bibliography: kairos-110.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

[kairos](https://packages.tesselle.org/kairos/) 1.1.0 is now on [<abbr title="Comprehensive R Archive Network">CRAN</abbr>](https://cran.r-project.org/)! kairos is a toolkit for the analysis of chronological patterns from archaeological count data.

You can install it from CRAN with:

```{r, eval=FALSE}
install.packages("kairos")
```

The range of tools provided by kairos is now extended by two methods for matrix seriation^[The move to add these matrix seriation methods, previously implemented in [tabula](https://packages.tesselle.org/tabula/), follows a reorganization for consistency so that we no longer have chronology tools in two separate packages. This implies that the seriation methods are temporarily re-exported by tabula from kairos and will be removed in a future version of tabula.], allowing the construction of relative chronologies:

* Reciprocal ranking: `seriate_rank()`
* Correspondence analysis: `seriate_average()`

The `seriate_*()` methods return a permutation of the rows and columns (according to the `margin` argument) of a count data `matrix` or `data.frame`. Then, `permute()` performs the reordering.

This post briefly illustrates how to perform a correspondence analysis based seriation.

```{r}
library(kairos)
```

Correspondence Analysis (CA) is an effective method for the seriation of archaeological assemblages. The order of the rows and columns is given by the coordinates along one dimension of the CA space, assumed to account for temporal variation. The direction of temporal change within the correspondence analysis space is arbitrary: additional information is needed to determine the actual order in time.

```{r ca-ford, layout="l-page", fig.width=12, fig.height=7}
## Load the zuni dataset
# install.packages("folio")
data("zuni", package = "folio")

## Plot the original matrix
tabula::plot_ford(zuni) +
  ggplot2::theme(axis.text.y = ggplot2::element_blank())
```

```{r ca-seriation}
## Get row and column permutations from CA coordinates along the first axis
indices <- seriate_average(zuni, margin = c(1, 2), axes = 1)
get_order(indices)
```

`seriate_average()` also contains the full results of the correspondence analysis. You can use [dimensio](https://packages.tesselle.org/dimensio/) to explore these results:

```{r ca-plot, fig.width=5, fig.height=5, out.width='50%', fig.show='hold'}
## Plot CA row coordinates (get a nice arch effect!)
dimensio::plot_rows(indices) +
  ggplot2::theme_bw() +
  ggplot2::theme(legend.position = "none")

## Plot column contributions to the first two axes
dimensio::plot_contributions(indices, margin = 2, axes = c(1, 2)) +
  ggplot2::theme_bw()
```

If the results of the correspondence analysis are satisfactory, we can then permute the rows and columns of the initial data matrix:

```{r ca-permuted, layout="l-page", fig.width=12, fig.height=7, preview=TRUE}
## Permute rows and columns
permuted <- permute(zuni, indices)

## Plot permuted matrix
tabula::plot_ford(permuted) +
  ggplot2::theme(axis.text.y = ggplot2::element_blank())
```
